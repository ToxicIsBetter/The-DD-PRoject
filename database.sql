DROP TABLE DIRECT_DEBITS;

CREATE TABLE DIRECT_DEBITS
(
    ACCOUNT_NAME VARCHAR2(30) NOT NULL,
    BALANCE VARCHAR2(30),
    STATEMENT_DATE DATE,
    BUFFER_DAYS NUMERIC,
    DD_DATE DATE,
    BANK VARCHAR2(10) NOT NULL,
    CREDIT_LIMIT NUMERIC(10),
    PRIMARY KEY (ACCOUNT_NAME)
);

INSERT INTO DIRECT_DEBITS VALUES('THREE', 8, TO_DATE('18/11/2024', 'DD/MM/YYYY'), 7, TO_DATE('25/11/2024', 'DD/MM/YYYY'), 'NATWEST', 0);
INSERT INTO DIRECT_DEBITS VALUES('CAPITAL_ONE', 0, TO_DATE('05/11/2024', 'DD/MM/YYYY'), 23, TO_DATE('28/11/2024', 'DD/MM/YYYY'), 'NATWEST', 200);
INSERT INTO DIRECT_DEBITS VALUES('118 118 MONEY', 131.38, TO_DATE('12/11/2024', 'DD/MM/YYYY'), 19, TO_DATE('01/12/2024', 'DD/MM/YYYY'), 'BARCLAYS', 250);
INSERT INTO DIRECT_DEBITS VALUES('AQUA', 155.8, TO_DATE('16/11/2024', 'DD/MM/YYYY'), 18, TO_DATE('04/12/2024', 'DD/MM/YYYY'), 'NATWEST', 1450);
INSERT INTO DIRECT_DEBITS VALUES('ZABLE', 0, TO_DATE('23/11/2024', 'DD/MM/YYYY'), 5, TO_DATE('28/11/2024', 'DD/MM/YYYY'), 'BARCLAYS', 350);
INSERT INTO DIRECT_DEBITS VALUES('ZOPA', 101.22, TO_DATE('13/11/2024', 'DD/MM/YYYY'), 18, TO_DATE('01/12/2024', 'DD/MM/YYYY'), 'NATWEST', 0);
INSERT INTO DIRECT_DEBITS VALUES('GOOGLE', 24.55, TO_DATE('05/11/2024', 'DD/MM/YYYY'), 0, TO_DATE('05/11/2024', 'DD/MM/YYYY'), 'NATWEST', 0);
INSERT INTO DIRECT_DEBITS VALUES('SAMSUNG', 83.27, TO_DATE('01/11/2024', 'DD/MM/YYYY'), 7, TO_DATE('01/11/2024', 'DD/MM/YYYY'), 'NATWEST', 0);
-- INSERT INTO DIRECT_DEBITS VALUES('NATWEST REWARDS', 2, TO_DATE('18/11/2024', 'DD/MM/YYYY'), 7, TO_DATE('25/11/2024', 'DD/MM/YYYY'), 'NATWEST', 0);

SELECT SUM(BALANCE) AS TOTAL_TO_PAY_IN_NOVEMBER
FROM DIRECT_DEBITS
WHERE DD_DATE > SYSDATE;

SELECT SUM(BALANCE) AS TOTAL_TO_PAY_IN_NOVEMBER
FROM DIRECT_DEBITS
WHERE DD_DATE > SYSDATE AND BANK = 'NATWEST';

SELECT SUM(BALANCE) AS TOTAL_TO_PAY_IN_NOVEMBER
FROM DIRECT_DEBITS
WHERE DD_DATE > SYSDATE AND BANK = 'BARCLAYS';

SELECT ACCOUNT_NAME, BALANCE, STATEMENT_DATE
FROM DIRECT_DEBITS
WHERE DD_DATE > SYSDATE AND BANK = 'NATWEST';

SELECT ACCOUNT_NAME, BALANCE, STATEMENT_DATE
FROM DIRECT_DEBITS
WHERE DD_DATE > SYSDATE AND BANK = 'BARCLAYS';
